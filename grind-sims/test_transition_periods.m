% Test transition_periods.m


%% Tests without tolerance argument

assert(isequal(transition_periods([0 0 0 3 3 3 3]), ...
	{[4 7]}))
assert(isequal(transition_periods([0 0 0 3 3 3 3]'), ...
	{[4 7]}))
assert(isequal(transition_periods([3 3 3 3 0 0 0]), ...
	{[5 7]}))
assert(isequal(transition_periods([3 3 3 3 0 0 0]'), ...
	{[5 7]}))
assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4]), ...
	{[4 6], [7 9], [10 12]}))
assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4]'), ...
	{[4 6], [7 9], [10 12]}))
assert(isequal(...
    transition_periods([0 0 0 0 1 1 1 1 0 0 0 0 -1 -1 0 0 1 0 -1]), ...
    {[5 8], [9 12], [13 14], [15 16], [17 17], [18 18], [19 19]} ...
))


%% Tests with tolerance argument

assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4], 0), ...
	{[4 6], [7 9], [10 12]}))
assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4], 0.1), ...
	{[4 6], [7 9], [10 12]}))
assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4], 0.99), ...
	{[4 6], [7 9], [10 12]}))
assert(isequal(transition_periods([1 1 1 2 2 2 3 3 3 4 4 4], 1), ...
    cell(1, 0)))
assert(isequal(transition_periods( ...
    [1.1 1.1 1.1 1.2 1.2 1.2 1.15 1.15 1.15 1.14 1.16 1.15], 0.05), ...
    {[4 6], [7 12]}))
