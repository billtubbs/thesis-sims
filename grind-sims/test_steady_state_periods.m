% Test steady_state_periods.m


%% Tests without tolerance argument

assert(isequal(steady_state_periods([0 0 0 3 3 3 3], 0), ...
	[   1   1   1   1   1   1   1]))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3]', 0), ...
	[   1   1   1   1   1   1   1]'))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3], 1), ...
	[   1   1   1   0   1   1   1]))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3]', 1), ...
	[   1   1   1   0   1   1   1]'))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3], 2), ...
	[   1   1   1   0   0   1   1]))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3], 4), ...
	[   1   1   1   0   0   0   0]))
assert(isequal(steady_state_periods([0 0 0 3 3 3 3], 5), ...
	[   1   1   1   0   0   0   0]))
assert(isequal(steady_state_periods([3 3 3 3 0 0 0], 1), ...
	[   1   1   1   1   0   1   1]))
assert(isequal(steady_state_periods([3 3 3 3 0 0 0], 2), ...
	[   1   1   1   1   0   0   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 1), ...
	[   1   1   1   0   1   1   0   1   1   0   1   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 2), ...
	[   1   1   1   0   0   1   0   0   1   0   0   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 3), ...
	[   1   1   1   0   0   0   0   0   0   0   0   0]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 4), ...
	[   1   1   1   0   0   0   0   0   0   0   0   0]))
assert(isequal(steady_state_periods([1 1 1], 1), ...
	[   1   1   1]))
assert(isequal(steady_state_periods([1 1 1], 0), ...
	[   1   1   1]))
assert(isequal(steady_state_periods([1], 0), ...
	[   1]))


%% Tests with tolerance argument

assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 2, 0.0), ...
	[   1   1   1   0   0   1   0   0   1   0   0   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 2, 0.1), ...
	[   1   1   1   0   0   1   0   0   1   0   0   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 2, 0.9), ...
	[   1   1   1   0   0   1   0   0   1   0   0   1]))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4]', 2, 0.9), ...
	[   1   1   1   0   0   1   0   0   1   0   0   1]'))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4], 2, 1), ...
	ones(1, 12)))
assert(isequal(steady_state_periods([1 1 1 2 2 2 3 3 3 4 4 4]', 2, 1), ...
	ones(12, 1)))
assert(isequal(steady_state_periods([0 0 0 -1 -1 -1 -2 -2 -2 -3 -3 -3], 2, 1), ...
	ones(1, 12)))
assert(isequal(steady_state_periods([0 0 0 -1 -1 -1 -2 -2 -2 -3 -3 -3]', 2, 1), ...
	ones(12, 1)))